 <!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Hisab Kitaab 2.0 â€“ Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet" />
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Poppins',sans-serif;background:#0f172a;color:#333;min-height:100vh;display:flex;justify-content:center;align-items:center;padding:30px}
.container{display:flex;width:950px;max-width:95%;border-radius:16px;overflow:hidden;box-shadow:0 15px 40px rgba(0,0,0,0.3);background:#fff}
.left-panel{flex:1;background:linear-gradient(145deg,#0f172a,#1e3a8a);color:#fff;padding:60px 50px;display:flex;flex-direction:column;justify-content:center}
.left-panel h1{font-size:38px;font-weight:700;margin-bottom:15px;color:#38bdf8}
.left-panel p{font-size:15px;line-height:1.7;margin-bottom:20px;color:#e2e8f0}
.support-box{margin-top:30px;background:rgba(255,255,255,0.1);border-left:4px solid #38bdf8;padding:12px 20px;border-radius:10px;font-size:14px;line-height:1.5}
.support-box span{display:block;margin-top:5px;color:#cbd5e1}
.right-panel{flex:1;background:#f8fafc;padding:60px 50px;display:flex;flex-direction:column;justify-content:center;position:relative}
.logo-icon{position:absolute;top:25px;right:40px;font-size:28px;color:#1e3a8a;transform:rotate(25deg)}
.right-panel h2{color:#0f172a;font-size:28px;font-weight:700;margin-bottom:10px}
.right-panel p{color:#6b7280;margin-bottom:35px;font-size:15px}
.form-group{margin-bottom:18px}
.form-group label{display:block;font-weight:500;margin-bottom:6px;color:#374151}
.form-group input{width:100%;padding:12px;border:1px solid #e5e7eb;border-radius:8px;font-size:15px;transition:border 0.2s}
.form-group input:focus{border-color:#2563eb;outline:none}
button{width:100%;padding:14px;border:none;border-radius:8px;background:#0f172a;color:#fff;font-weight:600;font-size:16px;cursor:pointer;transition:background 0.3s}
button:hover{background:#1e3a8a}
.remember{display:flex;align-items:center;gap:8px;margin-bottom:20px;color:#4b5563;font-size:14px}
.error{color:#dc2626;margin-top:8px;text-align:center}
.stats{display:flex;gap:20px;margin:20px 0;flex-wrap:wrap}
.stat{flex:1;background:#fafafa;border:1px solid #ddd;border-radius:8px;padding:15px;text-align:center}
.stat h4{font-size:1rem;color:#555;margin-bottom:6px}
.stat p{font-size:1.4rem;font-weight:700;color:#007bff}
.btn{padding:10px 15px;border:none;border-radius:4px;font-size:15px;font-weight:600;cursor:pointer;transition:.2s}
.btn-primary{background:#007bff;color:#fff}
.btn-danger{background:#dc3545;color:#fff}
.btn-success{background:#28a745;color:#fff}
.btn-warning{background:#ffc107;color:#212529}
#add-btn{position:fixed;bottom:30px;right:30px;background:#007bff;color:#fff;border:none;border-radius:50%;width:60px;height:60px;font-size:32px;cursor:pointer;box-shadow:0 4px 12px rgba(0,0,0,.3)}
.payment-card{background:#fafafa;border:1px solid #e0e0e0;border-radius:8px;padding:20px;margin-bottom:15px;box-shadow:0 2px 4px rgba(0,0,0,.03)}
.payment-card-header{display:flex;justify-content:space-between}
.amount{font-size:1.3rem;font-weight:700;color:#dc3545}
.actions{margin-top:10px;display:flex;gap:10px;flex-wrap:wrap}
.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.5);justify-content:center;align-items:center;z-index:100}
.modal-content{background:#fff;padding:20px;border-radius:8px;max-width:500px;width:90%}
.modal-content h3{margin-bottom:15px;color:#0f172a}
.modal-content .form-group{margin-bottom:12px}
.modal-content input,select{width:100%;padding:10px;border:1px solid #ccc;border-radius:4px;font-size:15px}
@media(max-width:900px){.container{flex-direction:column;width:100%;border-radius:0}.left-panel,.right-panel{text-align:center;padding:40px 30px}.logo-icon{right:20px;top:15px}}
</style>
</head>
<body>

<!-- LOGIN VIEW -->
<div id="login-view" class="container">
  <div class="left-panel">
    <h1>Hisab Kitaab</h1>
    <p><strong>Hisab Kitaab</strong> helps you record, manage, and track payments easily. Stay organized and send reminders instantly.</p>
    <div class="support-box">ðŸ“ž <strong>Customer Care:</strong> +91 9696066486<br><span>ðŸ•’ Available 8 AM â€“ 10 PM</span></div>
  </div>
  <div class="right-panel">
    <div class="logo-icon">â‚¹</div>
    <h2>Welcome back!</h2>
    <p>Please enter your login details</p>
    <form id="login-form">
      <div class="form-group">
        <label>Email</label>
        <input type="email" id="login-email" placeholder="email@example.com" required />
      </div>
      <div class="form-group">
        <label>Password</label>
        <input type="password" id="login-password" placeholder="Password" required />
      </div>
      <div class="remember">
        <input type="checkbox" id="remember" /> <label for="remember">Remember for 30 days</label>
      </div>
      <button type="submit">Log in</button>
      <p id="login-error" class="error"></p>
    </form>
  </div>
</div>

<!-- DASHBOARD VIEW -->
<div id="app-view" class="container" style="display:none;flex-direction:column;padding:30px;max-width:960px;">
<header .dashboard-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: #ffffff;
  padding: 15px 25px;
  border-radius: 12px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  margin-bottom: 25px;
}

.dashboard-title {
  color: #1e3a8a;
  font-size: 24px;
  font-weight: 700;
  letter-spacing: 0.5px;
}

.logout-btn {
  background: #dc2626;
  color: #fff;
  border: none;
  border-radius: 8px;
  padding: 10px 20px;
  font-size: 15px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
  width: auto;
  min-width: 100px;
  text-align: center;
}

.logout-btn:hover {
  background: #b91c1c;
  transform: scale(1.05);
}

</header>
<div class="stats">
<div class="stat"><h4>Total Debtors</h4><p id="total-debtors">0</p></div>
<div class="stat"><h4>Total Amount (INR)</h4><p id="total-amount">â‚¹ 0</p></div>
</div>
<h3 style="color:#1e3a8a;margin-bottom:10px;">Pending Payments</h3>
<div id="payment-list-container"></div>
</div>

<button id="add-btn" style="display:none;">+</button>

<!-- ADD/EDIT MODAL -->
<div id="payment-modal" class="modal">
<div class="modal-content">
<h3 id="modal-title">Add Payment</h3>
<form id="payment-form">
<input type="hidden" id="payment-id">
<div class="form-group"><label>Person Name</label><input id="person-name" required></div>
<div class="form-group"><label>Phone (+91 auto)</label><input id="phone-number" required></div>
<div class="form-group"><label>Amount (INR)</label><input type="number" id="amount" required></div>
<div class="form-group"><label>Due Date</label><input type="date" id="due-date" required></div>
<div class="form-group"><label>Frequency</label>
<select id="frequency" required>
<option value="One-Time">One-Time</option>
<option value="Monthly">Monthly</option>
<option value="Quarterly">Quarterly</option>
<option value="Yearly">Yearly</option>
<option value="Custom">Custom</option>
</select></div>
<button type="submit" class="btn btn-success">Save</button>
<button type="button" id="cancel-btn" class="btn btn-danger">Cancel</button>
</form>
</div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
<script>
const firebaseConfig={apiKey:"AIzaSyAUCh-kK_c14NxSTHVjBGaU1CsRr6UHfmo",authDomain:"hisab-kitaab-e803a.firebaseapp.com",projectId:"hisab-kitaab-e803a",storageBucket:"hisab-kitaab-e803a.appspot.com",messagingSenderId:"790490783778",appId:"1:790490783778:web:c96ef2b30f0c50d538ea7b"};
firebase.initializeApp(firebaseConfig);
const auth=firebase.auth(),db=firebase.firestore();

const loginView=document.getElementById('login-view'),
appView=document.getElementById('app-view'),
loginForm=document.getElementById('login-form'),
logoutBtn=document.getElementById('logout-btn'),
loginError=document.getElementById('login-error'),
paymentList=document.getElementById('payment-list-container'),
addBtn=document.getElementById('add-btn'),
modal=document.getElementById('payment-modal'),
cancelBtn=document.getElementById('cancel-btn'),
paymentForm=document.getElementById('payment-form'),
modalTitle=document.getElementById('modal-title'),
totalDebtors=document.getElementById('total-debtors'),
totalAmount=document.getElementById('total-amount');

let editingId=null;

// Toggle views based on auth state
auth.onAuthStateChanged(user=>{
 if(user){
   loginView.style.display='none';
   appView.style.display='flex';
   addBtn.style.display='block';
   fetchPayments();
 }else{
   appView.style.display='none';
   loginView.style.display='flex';
   addBtn.style.display='none';
 }
});

// LOGIN
loginForm.addEventListener('submit',e=>{
 e.preventDefault();
 const email=document.getElementById('login-email').value;
 const pass=document.getElementById('login-password').value;
 auth.signInWithEmailAndPassword(email,pass)
 .then(()=>{loginError.textContent='';loginForm.reset();})
 .catch(err=>loginError.textContent='Invalid email or password');
});

// LOGOUT
logoutBtn.onclick=()=>auth.signOut();

// ADD BUTTON
addBtn.onclick=()=>{editingId=null;modalTitle.textContent='Add Payment';paymentForm.reset();modal.style.display='flex';}
cancelBtn.onclick=()=>modal.style.display='none';

// SAVE PAYMENT
paymentForm.addEventListener('submit',async e=>{
 e.preventDefault();
 const user=auth.currentUser;if(!user)return alert("Please login first");
 let phone=document.getElementById('phone-number').value.trim();
 if(!phone.startsWith('91'))phone='91'+phone;
 const data={
   personName:document.getElementById('person-name').value,
   phoneNumber:phone,
   amount:parseFloat(document.getElementById('amount').value),
   dueDate:document.getElementById('due-date').value,
   frequency:document.getElementById('frequency').value,
   status:'Pending',
   userId:user.uid
 };
 try{
   if(editingId){await db.collection('payments').doc(editingId).update(data);alert("Payment updated!");}
   else{await db.collection('payments').add(data);alert("Payment added!");}
   modal.style.display='none';paymentForm.reset();
 }catch(err){alert("Error:"+err.message);}
});

// FETCH PAYMENTS
function fetchPayments(){
 const user=auth.currentUser;if(!user)return;
 db.collection('payments').where('userId','==',user.uid).where('status','==','Pending').orderBy('dueDate','asc')
 .onSnapshot(snap=>{
   paymentList.innerHTML='';let total=0;
   if(snap.empty){paymentList.innerHTML='<p>No pending payments.</p>';totalDebtors.textContent='0';totalAmount.textContent='â‚¹ 0';return;}
   snap.forEach(doc=>{const p=doc.data();p.id=doc.id;total+=p.amount;createCard(p);});
   totalDebtors.textContent=snap.size;
   totalAmount.textContent='â‚¹ '+total.toLocaleString('en-IN');
 });
}

// CREATE CARD
function createCard(p){
 const c=document.createElement('div');c.className='payment-card';c.setAttribute('data-id',p.id);
 c.innerHTML=`<div class="payment-card-header"><div><h4>${p.personName}</h4><p>${p.phoneNumber}</p></div><div class="amount">â‚¹${p.amount.toLocaleString('en-IN')}</div></div>
 <p><strong>Due:</strong> ${p.dueDate}</p><p><strong>Frequency:</strong> ${p.frequency}</p>
 <div class="actions">
 <button class="btn btn-warning btn-reminder">Reminder</button>
 <button class="btn btn-success btn-edit">Edit</button>
 <button class="btn btn-danger btn-delete">Delete</button>
 </div>`;
 paymentList.appendChild(c);
}

// ACTIONS
paymentList.addEventListener('click',e=>{
 const card=e.target.closest('.payment-card');if(!card)return;
 const id=card.dataset.id;
 if(e.target.classList.contains('btn-delete')){if(confirm("Delete this record?"))db.collection('payments').doc(id).delete();}
 if(e.target.classList.contains('btn-reminder')){
   const phone=card.querySelector('p').textContent;
   const name=card.querySelector('h4').textContent;
   const amount=card.querySelector('.amount').textContent;
   const msg=`Hello ${name}, your payment of ${amount} is pending. Please pay soon. Ignore if already paid.`;
   window.open(`https://wa.me/${phone}?text=${encodeURIComponent(msg)}`,'_blank');
 }
 if(e.target.classList.contains('btn-edit')){
   editingId=id;
   db.collection('payments').doc(id).get().then(doc=>{
     const d=doc.data();
     document.getElementById('person-name').value=d.personName;
     document.getElementById('phone-number').value=d.phoneNumber;
     document.getElementById('amount').value=d.amount;
     document.getElementById('due-date').value=d.dueDate;
     document.getElementById('frequency').value=d.frequency;
     modalTitle.textContent='Edit Payment';
     modal.style.display='flex';
   });
 }
});
window.onclick=e=>{if(e.target===modal)modal.style.display='none';}
</script>
</body>

</html>
